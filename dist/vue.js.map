{"version":3,"file":"vue.js","sources":["../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["// Observer类是干什么用的？\nclass Observer {\n    constructor(value) {// 需要对value属性重新定义\n        this.walk(value);// 把对象里的数据，一步一步地都变成响应式的\n    }\n    walk(data) {\n        // 将对象中的所有key，重新用defineProperty定义成响应式的\n        Object.keys(data).forEach(key => {\n            defineReactive(data, key, data[key]);\n        })\n    }\n}\n\nexport function defineReactive(data, key, value) {\n    Object.defineProperty(data, key, {\n        get() {\n            console.log(\"get\");\n            return value;\n        },\n        set(newValue) {\n            console.log(\"set\");\n            if (newValue === value) return;\n            value = newValue; \n        }\n    })\n}\n\nexport function observer(data) {\n    // 只能对对象类型进行侦测 非对象类型无法侦测\n    if (typeof data !== 'object' || data === null) {\n        return;\n    }\n    // 通过类来实现对数据的侦测 类可以方便扩展，会产生实例\n    return new Observer(data);// Observer是在原对象上监听数据的\n}","import { observer } from \"./observer/index.js\";\n\n// vue的数据有哪些？按照vue初始化的顺序有：props methods data computed watch\nexport function initState(vm) {\n    // 将所有数据都定义在vm属性上，并且后续更改 需要触发视图更新\n    const opts = vm.$options; // 获取用户属性\n    if (opts.data) { // 数据的初始化\n        initData(vm);\n    }\n\n}\n\nfunction proxy(vm, source, key) {\n    // 代理属性    为了用户能直接通过vm拿到data里的属性\n    Object.defineProperty(vm, key, {\n        get() {\n            console.log('get proxy');\n            return vm[source][key];\n        },\n        set(newValue) {\n            console.log('set proxy');\n            vm[source][key] = newValue;\n        }\n    });\n}\n\nfunction initData(vm) {\n    // 数据劫持 Object.defineProperty\n    let data = vm.$options.data;\n    // 对data类型进行判断 如果是函数 获取函数返回值作为对象\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data;// (注释1)\n    // 通过vm._data获取劫持后的数据，用户就可以拿到_data了\n    // 将_data中的数据全部放到vm上\n    for (let key in data) {\n        proxy(vm, '_data', key);// vm.name => vm._data.name\n    }\n    // 侦测这个数据\n    observer(data);\n}\n\n","import { initState } from \"./state\";\n\nexport function initMixin(Vue) {\n    Vue.prototype._init = function (options) {\n        const vm = this;\n        vm.$options = options; // 实例上有个属性$options 表示的是用户传入的所有属性\n\n        // 初始化状态\n        initState(vm);\n    }\n}","// vue在2.0版本中就是一个构造函数\n\nimport { initMixin } from \"./init\";\n\nfunction Vue(options) {\n    this._init(options); // 当用户new Vue时，就调用init方法进行vue的初始化\n}\n// 可以拆分逻辑到不同的文件中，利于代码维护\ninitMixin(Vue);\n\n\nexport default Vue;"],"names":["Observer","value","walk","data","Object","keys","forEach","key","defineReactive","defineProperty","get","console","log","set","newValue","observer","initState","vm","opts","$options","initData","proxy","source","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":"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"}